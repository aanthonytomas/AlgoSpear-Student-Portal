import{j as d}from"./jlconfig-bK2FoTvF.js";import{d as D,i as O,S as c,t as g,_ as C,c as l,a as t,F as B,h as Y,o,j as h,g as V,n as G,l as j,p as v,e as y,k as R,m as Q,w as S,f,q as U,s as q,v as H}from"./index-D7cRCgpj.js";import{i as b}from"./check-2PA5G-d2.js";import{q as M}from"./url-HQ3Cey_0.js";import{_ as K,f as W}from"./excercises-banner-LhtmD0ag.js";import{r as J}from"./randomNumber-C27Mv2PT.js";import{S as z,f as F}from"./swiper-vue-fHe_OmiB.js";import{a as X,S as Z}from"./SectionFooter-upHGNFKG.js";import{S as ss}from"./config-Cif4XynF.js";import{q as es}from"./insertGetID-BAx1ISz1.js";import{t as ts}from"./timer-OaxQmgbO.js";import{E as is}from"./ElemProgressbar-DxHRhbjo.js";import"./count-B2fEAVCc.js";import"./format-CV38ky4f.js";const as=D({name:"TopicList",emits:["view"],props:{excercise:{default:{},type:Object}},setup(){return{jlconfig:d}},methods:{onSelectExam(s,e){O()?e?c.fire({title:"Complete learning materials",text:"You did not read all the materials of this topic",icon:"info"}):this.$emit("view",g(s)):c.fire({title:"Sign In Required",html:"Please Login first",icon:"info"})}}}),rs={class:"p-5 mx-5"},ns={class:"row"},os={class:"card"},ls={class:"card-body"},ds={key:0,class:"badge bg-success"},cs={key:1,class:"badge bg-danger"},us={key:2,class:"badge bg-secondary"},hs={class:"card-footer d-flex justify-content-end"},ms=["onClick"],fs={key:0,class:"bi bi-lock-fill me-1"},ps={key:1,class:"bi bi-unlock-fill me-1"};function _s(s,e,a,n,p,_){return o(),l("div",rs,[t("div",ns,[(o(!0),l(B,null,Y(s.excercise,(i,r)=>{var u;return o(),l("div",{class:"col-4 mb-5",key:r},[t("div",os,[e[4]||(e[4]=t("img",{src:K},null,-1)),t("div",ls,[t("h3",null,h((u=i==null?void 0:i.header)==null?void 0:u.name),1),t("table",null,[t("tbody",null,[t("tr",null,[e[0]||(e[0]=t("td",{style:{width:"180px"}},"Number of items",-1)),t("td",null,": "+h(s.jlconfig.excercises_limit),1)]),t("tr",null,[e[2]||(e[2]=t("td",null,"Status",-1)),t("td",null,[e[1]||(e[1]=V(": ")),(i==null?void 0:i.attempt)>0&&(i==null?void 0:i.passed)==!0?(o(),l("span",ds,"Passed")):(i==null?void 0:i.attempt)>0&&(i==null?void 0:i.passed)==!1?(o(),l("span",cs,"Fail")):(o(),l("span",us,"Pending"))])]),t("tr",null,[e[3]||(e[3]=t("td",null,"Number of Attempts",-1)),t("td",null,": "+h(i==null?void 0:i.attempt),1)])])])]),t("div",hs,[t("button",{class:G(["btn w-100",i!=null&&i.locked?"btn-secondary":"btn-primary"]),onClick:m=>s.onSelectExam(i,i==null?void 0:i.locked)},[i!=null&&i.locked?(o(),l("i",fs)):(o(),l("i",ps)),t("span",null,h(i!=null&&i.locked?"Locked":(i==null?void 0:i.attempt)>0&&!(i!=null&&i.passed)?"Take again":(i==null?void 0:i.attempt)>0&&(i!=null&&i.passed)?"Completed":"Start Now"),1)],10,ms)])])])}),128))])])}const ys=C(as,[["render",_s],["__scopeId","data-v-9f327362"]]),gs=D({name:"TopicList",emits:["back","passed","fail"],props:{reset:{default:0,type:Number},category:{default:{},type:Object},questionnaires:{default:{},type:Object}},components:{Swiper:F,SwiperSlide:z},data(){return{loading:{btn_submit:!1},user:{},swiper:{},list:[],score:0,passed:0,timer:10,timeDisplay:{},exercise_duration:0,backButton:!1,stopTimer:null,isTimeUp:!1}},methods:{startTimer(){this.stopTimer=ts(async s=>{v("Reading Time:",g(s)),this.timeDisplay=s,(s==null?void 0:s.seconds)==0&&(console.log("time is up"),this.isTimeUp=!0,this.$router.push({path:this.$route.path,query:{isExerciseOngoing:"false"}}),c.fire({title:"Time's up",text:"Your exercise time has ended.",icon:"info"}).then(async()=>{await this.onSaveExcercises().then(async()=>{this.loading.btn_submit=!1,this.passed==1?c.fire({title:"Congratulations",text:"You passed the exercise with score of "+this.score+" out of "+d.excercises_limit+".",icon:"success"}).then(async()=>{this.$emit("passed")}):c.fire({title:"You fail",text:"You fail to pass with score of "+this.score+" out of "+d.excercises_limit+".",icon:"error"}).then(async()=>{this.$emit("fail")})})}))},this.exercise_duration)},async onBack(){c.fire({title:"Are you sure?",text:"You will lose all your progress, are you sure you want to leave?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, cancel it",cancelButtonText:"No, continue"}).then(async s=>{var e;s.isConfirmed&&(this.stopTimer&&clearInterval((e=this.timeDisplay)==null?void 0:e.intervalID),this.$router.push({path:this.$route.path,query:{}}),this.$emit("back"))})},async onSubmitAnswer(s){if(!this.list[s].answer_input)this.$toast.warning("Please provide your answer.");else{var e=this.list[s].answer.toLowerCase(),a=this.list[s].answer_input.toLowerCase();e==a?(this.score=this.score+1,this.list[s].is_corrrect=1):this.list[s].is_corrrect=0,this.swiper.isEnd?(this.score>=d.excercises_limit_passing&&(this.passed=1),this.loading.btn_submit=!0,await this.onSaveExcercises().then(async()=>{this.loading.btn_submit=!1,this.$router.push({path:this.$route.path,query:{isExerciseOngoing:"false"}}),this.passed==1?c.fire({title:"Congratulations",text:"You passed the exercise with score of "+this.score+" out of "+d.excercises_limit+".",icon:"success"}).then(async()=>{this.$emit("passed")}):c.fire({title:"You fail",text:"You fail to pass with score of "+this.score+" out of "+d.excercises_limit+".",icon:"error"}).then(async()=>{this.$emit("fail")})})):this.swiper.slideNext()}},async onSaveExcercises(){var s,e,a;await es({connection:ss().CONN_NPM_LMS,table:"questionnaire_category_done",columns:{user_refid:(s=this.user)==null?void 0:s.user_refid,category_refid:(a=(e=this.category)==null?void 0:e.header)==null?void 0:a.group_refid,total:d.excercises_limit,score:this.score,passed:this.passed}})},onSwiper(s){this.swiper=s}},watch:{timeDisplay:function(s,e){(s==null?void 0:s.intervalID)!==(e==null?void 0:e.intervalID)&&(this.stopTimer&&clearInterval(this.stopTimer),this.startTimer())},reset:async function(){if(this.reset>0){var s=await j();s?(this.user=s,this.list=this.questionnaires,this.score=0,this.passed=0,this.isTimeUp=!1,this.swiper.slideTo(0),v("Props:",g(this.$props)),v("Data:",g(this.$data)),this.$router.push({path:this.$route.path,query:{isExerciseOngoing:"true"}}),this.startTimer()):c.fire({title:"Sign In Required",text:"You need to sign in to start an exercises",icon:"info"}).then(async()=>{this.$router.replace("/login")})}}},created(){this.exercise_duration=d.exercise_time*60},beforeUnmount(){var s;this.stopTimer&&clearInterval((s=this.timeDisplay)==null?void 0:s.intervalID),console.log("Component Destroyed!")}}),ws={class:"text-center"},bs={class:"row"},vs={class:"col-sm-12 col-lg-6"},$s={class:"d-flex align-items-center"},Ss={class:"p-0 m-0",style:{"line-height":"1"}},ks={key:0,class:"progress rounded-0 mt-2",style:{height:"6px"}},Es={class:"card mb-4"},Ts={class:"card-header"},Ds={class:"card-body"},Cs={class:"input-group mb-3"},xs=["onUpdate:modelValue"],As={class:"card-footer d-flex justify-content-end"},Ls=["onClick","disabled"],Ps={class:"d-flex justify-content-start"};function Is(s,e,a,n,p,_){var u,m,w,k,E,T,x,A,L,P;const i=f("swiper-slide"),r=f("swiper");return o(),l("div",null,[t("h1",ws,h((m=(u=s.category)==null?void 0:u.header)==null?void 0:m.name),1),t("div",bs,[e[4]||(e[4]=t("div",{class:"col-sm-0 col-lg-3"},null,-1)),t("div",vs,[t("div",$s,[e[2]||(e[2]=t("div",null,[t("i",{class:"bi bi-alarm fs-2 me-2"})],-1)),t("div",null,[t("p",Ss,[t("small",null,"Time: "+h((w=s.timeDisplay)!=null&&w.formatted?(k=s.timeDisplay)==null?void 0:k.formatted:"00:00:00")+" | Used: "+h((E=s.timeDisplay)!=null&&E.percentage?((x=(T=s.timeDisplay)==null?void 0:T.percentage)==null?void 0:x.used)+"%":"0%"),1),e[1]||(e[1]=t("br",null,null,-1))]),(A=s.timeDisplay)!=null&&A.percentage?(o(),l("div",ks,[t("div",{class:"progress-bar progress-bar-striped",role:"progressbar",style:Q({width:((P=(L=s.timeDisplay)==null?void 0:L.percentage)==null?void 0:P.used)+"%"}),"aria-valuenow":10,"aria-valuemin":0,"aria-valuemax":"100"},null,4)])):R("",!0)])]),y(r,{"slides-per-view":1,onSwiper:s.onSwiper},{default:S(()=>[(o(!0),l(B,null,Y(s.list,($,I)=>(o(),U(i,{class:"swiper-no-swiping"},{default:S(()=>[t("div",Es,[t("div",Ts,"Question: "+h(I+1),1),t("div",Ds,[t("p",null,h($==null?void 0:$.question),1),t("div",Cs,[e[3]||(e[3]=t("span",{class:"input-group-text"},"Answer",-1)),q(t("input",{"onUpdate:modelValue":N=>$.answer_input=N,type:"text",class:"form-control"},null,8,xs),[[H,$.answer_input]])])]),t("div",As,[t("button",{class:"btn btn-primary w-50",onClick:N=>s.onSubmitAnswer(I),disabled:s.loading.btn_submit},h(s.loading.btn_submit?"Please wait..":"Submit Answer"),9,Ls)])])]),_:2},1024))),256))]),_:1},8,["onSwiper"]),t("div",Ps,[t("button",{class:"btn btn-secondary btn-lg me-4 w-50",onClick:e[0]||(e[0]=$=>s.onBack())},"Back")])]),e[5]||(e[5]=t("div",{class:"col-sm-0 col-lg-3"},null,-1))])])}const Ns=C(gs,[["render",Is]]),Bs=D({components:{ElemProgressbar:is,ExamSpace:Ns,TopicList:ys,SectionHeader:Z,SectionFooter:X,Swiper:F,SwiperSlide:z},setup(){return{jlconfig:d}},data(){return{timeDisplay:{},exerciseStarted:!1,loading:!1,user:{},btn:{array:!0,search:!1,sorting:!1,linked_list:!1,graphs:!1,stacks:!1,queues:!1},linked_list_locked:!1,list_stacks_locked:!1,list_queues_locked:!1,list_graphs_locked:!1,list_arrays_locked:!1,list_sorting_locked:!1,list_searching_locked:!1,swiper:{},excercise:{},reset:0,category:{},questionnaires:{},all_passed:!1,examVue:!0}},methods:{async isArticleGroupDoneLocal(){var s,e,a,n,p,_,i;await b((s=this.user)==null?void 0:s.user_refid,"ARRAYS").then(async r=>{this.list_arrays_locked=!(r!=null&&r.success)}),await b((e=this.user)==null?void 0:e.user_refid,"LINKED_LIST").then(async r=>{this.linked_list_locked=!(r!=null&&r.success)}),await b((a=this.user)==null?void 0:a.user_refid,"STACKS").then(async r=>{this.list_stacks_locked=!(r!=null&&r.success)}),await b((n=this.user)==null?void 0:n.user_refid,"QUEUES").then(async r=>{this.list_queues_locked=!(r!=null&&r.success)}),await b((p=this.user)==null?void 0:p.user_refid,"GRAPHS").then(async r=>{this.list_graphs_locked=!(r!=null&&r.success)}),await b((_=this.user)==null?void 0:_.user_refid,"SORTING").then(async r=>{this.list_sorting_locked=!(r!=null&&r.success)}),await b((i=this.user)==null?void 0:i.user_refid,"SEARCH").then(async r=>{this.list_searching_locked=!(r!=null&&r.success)})},async initExercises(){var s;this.loading=!0,await M({url:"util_quiz/initExcercises?user_refid="+((s=this.user)==null?void 0:s.user_refid)+"&limit="+d.excercises_limit}).then(async e=>{this.loading=!1,e=e.map(a=>{var p,_,i,r,u,m,w;let n=!0;return((p=a==null?void 0:a.header)==null?void 0:p.name)=="Array"?n=this.list_arrays_locked:((_=a==null?void 0:a.header)==null?void 0:_.name)=="Linked List"?n=this.linked_list_locked:((i=a==null?void 0:a.header)==null?void 0:i.name)=="Stacks"?n=this.list_stacks_locked:((r=a==null?void 0:a.header)==null?void 0:r.name)=="Queues"?n=this.list_queues_locked:((u=a==null?void 0:a.header)==null?void 0:u.name)=="Graphs"?n=this.list_graphs_locked:((m=a==null?void 0:a.header)==null?void 0:m.name)=="Sorting"?n=this.list_sorting_locked:((w=a==null?void 0:a.header)==null?void 0:w.name)=="Searching"&&(n=this.list_searching_locked),{...a,locked:n}}),this.excercise=e,console.log("exercise, ",this.excercise),this.isPassedAll()})},isPassedAll(){var s=0;for(let e=0;e<this.excercise.length;e++)this.excercise[e].passed&&(s=s+1);v("Over all status",{total:this.excercise.length,passed:s}),this.excercise.length==s?this.all_passed=!0:this.all_passed=!1},async viewExam(s){var e;v("View Exam",s),s!=null&&s.passed?c.fire({title:"Completed",text:"You've passed the excercises already",icon:"info"}):(this.examVue=!0,this.loading=!0,this.category=g(s),await W({group_refid:(e=s==null?void 0:s.header)==null?void 0:e.group_refid,limit:d.excercises_limit}).then(async a=>{a=a==null?void 0:a.filter(n=>!(n!=null&&n.is_choices)).slice(0,d.excercises_limit),a.length<d.excercises_limit?(c.fire({title:"Wait",text:"Questions in this exercise are not yet prepared.",icon:"info"}),this.loading=!1):(this.loading=!1,this.questionnaires=g(a),this.reset=J(),this.swiper.slideTo(1),this.exerciseStarted=!0)}))},onSwiper(s){this.swiper=s},onBack(){this.swiper.slideTo(0),this.examVue=!1},async onPassed(){this.swiper.slideTo(0),await this.initExercises().then(async()=>{})},async onFail(){this.swiper.slideTo(0),await this.initExercises().then(async()=>{})},async proceedToQuiz(){this.all_passed?this.$router.replace("/quizzes"):c.fire({title:"Invalid Action",text:"You need to pass all excercises to proceed in the quiz",icon:"info"})}},async mounted(){var s=await j();s&&(this.user=s),await this.isArticleGroupDoneLocal().then(async()=>{v("Excercises:",g(this.$data))}),await this.initExercises().then(async()=>{v("Excercises:",g(this.$data))}),this.$router.push({path:this.$route.path,query:{}})}}),Ys={class:"main"},js={class:"container py-5"},Rs={class:"row mt-5 pt-5"},Us={class:"col-4"},zs={class:"col-12"},Fs={class:"col-12"},Os={class:"d-flex justify-content-center"},Vs={key:0,class:"bi bi-lock-fill me-1"},Gs={key:1,class:"bi bi-unlock-fill me-1"};function Qs(s,e,a,n,p,_){const i=f("SectionHeader"),r=f("ElemProgressbar"),u=f("TopicList"),m=f("swiper-slide"),w=f("ExamSpace"),k=f("swiper"),E=f("SectionFooter");return o(),l("div",null,[y(i),t("main",Ys,[t("div",js,[t("div",Rs,[e[3]||(e[3]=t("div",{class:"col-12"},[t("h1",{class:"text-center display-6 fw-bold"},"Exercises"),t("p",{class:"text-center"},"Please complete reading materials to start exercises")],-1)),e[4]||(e[4]=t("div",{class:"col-4"},null,-1)),t("div",Us,[y(r,{loading:s.loading},null,8,["loading"])]),e[5]||(e[5]=t("div",{class:"col-4"},null,-1)),t("div",zs,[y(k,{"slides-per-view":1,"space-between":0,onSwiper:s.onSwiper},{default:S(()=>[y(m,{class:"swiper-no-swiping"},{default:S(()=>[y(u,{excercise:s.excercise,onView:s.viewExam},null,8,["excercise","onView"])]),_:1}),s.examVue?(o(),U(m,{key:0,class:"swiper-no-swiping"},{default:S(()=>[y(w,{reset:s.reset,category:s.category,questionnaires:s.questionnaires,onBack:s.onBack,onPassed:s.onPassed,onFail:s.onFail},null,8,["reset","category","questionnaires","onBack","onPassed","onFail"])]),_:1})):R("",!0)]),_:1},8,["onSwiper"])]),t("div",Fs,[e[2]||(e[2]=t("p",{class:"text-center"},"You may proceed to Quiz after passing all of the Exercises.",-1)),t("div",Os,[t("button",{class:"btn btn-primary btn-lg",onClick:e[0]||(e[0]=T=>s.proceedToQuiz())},[s.all_passed?(o(),l("i",Gs)):(o(),l("i",Vs)),e[1]||(e[1]=t("span",null,"Proceed to Quiz",-1))])])])])])]),y(E)])}const ne=C(Bs,[["render",Qs],["__scopeId","data-v-d26f0e20"]]);export{ne as default};
