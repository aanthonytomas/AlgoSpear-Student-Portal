import{d as _,i as P,_ as U,c as g,e as f,a as e,f as p,m as N,v as u,y as c,k as q,g as b,j as M,w as $,o as h}from"./index-DvlkE_cf.js";import{S as y}from"./config-Cif4XynF.js";import{q as D}from"./insertGetID-BzXFYlxR.js";import{q as V}from"./count-Bbc1EGQ3.js";import{S as k,a as A}from"./SectionFooter-TeUX6E9y.js";import"./format-CV38ky4f.js";function F(t){var s=3;let n="";const i="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",l=i.length;let d=0;for(;d<s;)n+=i.charAt(Math.floor(Math.random()*l)),d+=1;var a=new Date,r=a.getFullYear(),m=a.getMonth()+1,o=a.getDate(),w=a.getHours(),v=a.getMinutes(),S=a.getSeconds(),C=r+""+m+o+w+v+S;return t+"-"+C+"-"+n}async function L({firstname:t,lastname:s,email:n,password:i,confirm_password:l,created_by:d}){let a=!1;return await V({connection:y().CONN_NPM_LMS,table:"users_student",where:[["email",n]]}).then(async r=>a=!!r),new Promise(async r=>{if(t=="")return r({success:!1,message:"First name is required"});if(s=="")return r({success:!1,message:"Last name is required"});if(n=="")return r({success:!1,message:"Please provide a username"});if(i=="")return r({success:!1,message:"Please provide default password"});if(l=="")return r({success:!1,message:"Please confirm your password"});if(i!==l)return r({success:!1,message:"Password doesn't match"});if(i.length<8)return r({success:!1,message:"Password must be 8 or more characters"});if(n.length<5)return r({success:!1,message:"Username must be at least 5 characters"});if(a)return r({success:!1,message:"Username already in use"});var m=F("STD");await D({connection:y().CONN_NPM_LMS,table:"users_student",columns:{user_refid:m,firstname:t,lastname:s,email:n,password:i,created_by:d}}).then(async o=>r(o))})}const T=_({name:"SignUpPage",components:{SectionFooter:A,SectionHeader:k},data(){return{loading:!1,form:{email:"",password:"",confirm_password:"",firstname:"",lastname:"",created_by:""}}},methods:{resetData(){this.form.email="",this.form.firstname="",this.form.lastname="",this.form.created_by="",this.form.password="",this.form.confirm_password=""},async register(){if(this.form.password!==this.form.confirm_password){this.$toast.warning("Passwords do not match");return}if(this.form.email.length<5){this.$toast.warning("Username must be at least 5 characters");return}this.loading=!0;try{const t=await L(this.form);t.success?(this.resetData(),this.$toast.success((t==null?void 0:t.message)||"Account created successfully"),setTimeout(()=>{this.$router.push("/login")},1500)):this.$toast.warning((t==null?void 0:t.message)||"Registration failed")}catch(t){this.$toast.error("An error occurred while creating your account"),console.error(t)}finally{this.loading=!1}}},async mounted(){P()&&this.$router.replace("/")}}),H={class:"auth-wrapper"},I={class:"main py-5"},x={class:"auth-container mt-5"},B={class:"card mt-5 border-0"},E={class:"card-body p-5"},O={class:"auth-form"},R={class:"row"},G={class:"col-md-6 mb-4"},Y={class:"col-md-6 mb-4"},j={class:"mb-4"},J={class:"input-group"},K={class:"mb-4"},Q={class:"input-group"},W={class:"mb-4"},X={class:"input-group"},Z={class:"d-grid gap-2 mt-4"},z=["disabled"],ss={key:0,class:"spinner-border spinner-border-sm me-2",role:"status"},es={class:"text-center mt-4"};function ts(t,s,n,i,l,d){const a=p("SectionHeader"),r=p("router-link"),m=p("SectionFooter");return h(),g("div",H,[f(a),e("main",I,[e("div",x,[e("div",B,[e("div",E,[e("div",O,[s[18]||(s[18]=e("div",{class:"text-center mb-4"},[e("h1",{class:"display-6 fw-bold"},"AlgoSpear"),e("p",{class:"text-muted"},"Create your account")],-1)),e("form",{onSubmit:s[5]||(s[5]=N((...o)=>t.register&&t.register(...o),["prevent"]))},[e("div",R,[e("div",G,[s[6]||(s[6]=e("label",{class:"form-label"},"First Name",-1)),u(e("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>t.form.firstname=o),class:"form-control form-control-lg",type:"text",placeholder:"Enter your first name",required:""},null,512),[[c,t.form.firstname]])]),e("div",Y,[s[7]||(s[7]=e("label",{class:"form-label"},"Last Name",-1)),u(e("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>t.form.lastname=o),class:"form-control form-control-lg",type:"text",placeholder:"Enter your last name",required:""},null,512),[[c,t.form.lastname]])])]),e("div",j,[s[9]||(s[9]=e("label",{class:"form-label"},"Username",-1)),e("div",J,[s[8]||(s[8]=e("span",{class:"input-group-text bg-light border-end-0"},[e("i",{class:"bi bi-person"})],-1)),u(e("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.form.email=o),class:"form-control form-control-lg border-start-0",type:"text",placeholder:"Choose a username (min. 5 characters)",required:""},null,512),[[c,t.form.email]])]),s[10]||(s[10]=e("small",{class:"text-muted"},"Username must be at least 5 characters",-1))]),e("div",K,[s[12]||(s[12]=e("label",{class:"form-label"},"Password",-1)),e("div",Q,[s[11]||(s[11]=e("span",{class:"input-group-text bg-light border-end-0"},[e("i",{class:"bi bi-lock"})],-1)),u(e("input",{"onUpdate:modelValue":s[3]||(s[3]=o=>t.form.password=o),class:"form-control form-control-lg border-start-0",type:"password",placeholder:"Create a password",required:""},null,512),[[c,t.form.password]])]),s[13]||(s[13]=e("small",{class:"text-muted"},"Password must be at least 8 characters",-1))]),e("div",W,[s[15]||(s[15]=e("label",{class:"form-label"},"Confirm Password",-1)),e("div",X,[s[14]||(s[14]=e("span",{class:"input-group-text bg-light border-end-0"},[e("i",{class:"bi bi-lock-fill"})],-1)),u(e("input",{"onUpdate:modelValue":s[4]||(s[4]=o=>t.form.confirm_password=o),class:"form-control form-control-lg border-start-0",type:"password",placeholder:"Confirm your password",required:""},null,512),[[c,t.form.confirm_password]])])]),e("div",Z,[e("button",{type:"submit",class:"btn btn-primary btn-lg",disabled:t.loading},[t.loading?(h(),g("span",ss)):q("",!0),b(" "+M(t.loading?"Creating account...":"Create Account"),1)],8,z)])],32),e("div",es,[s[17]||(s[17]=e("p",{class:"text-muted mb-0"},"Already have an account?",-1)),f(r,{to:"/login",class:"btn btn-outline-primary mt-2"},{default:$(()=>s[16]||(s[16]=[b("Sign in")])),_:1})])])])])])]),f(m)])}const ds=U(T,[["render",ts],["__scopeId","data-v-0d22044b"]]);export{ds as default};
