import{j as w}from"./jlconfig-C6IE3CR_.js";import{d as V,i as J,S as b,t as S,_ as M,c as a,a as s,F as A,h as N,o as r,j as c,g as L,n as I,k as E,l as H,m as X,p as q,q as R,u as Z,s as Y,e as k,w as P,f as v,v as T,x as B,y as ee}from"./index-DvlkE_cf.js";import{i as C}from"./check-nSgYt6KK.js";import{q as se}from"./url-vEo-O14B.js";import{_ as te,f as ie}from"./new-banner-B74pRt1J.js";import{r as oe}from"./randomNumber-C27Mv2PT.js";import{S as W,f as K}from"./swiper-vue-CSzQAeur.js";import{a as ne,S as re}from"./SectionFooter-TeUX6E9y.js";import{S as ae}from"./config-Cif4XynF.js";import{q as le}from"./insertGetID-BzXFYlxR.js";import{t as de}from"./timer-OaxQmgbO.js";import{E as ce}from"./ElemProgressbar-Br5UniB-.js";import"./count-Bbc1EGQ3.js";import"./format-CV38ky4f.js";const ue=V({name:"TopicList",emits:["view"],props:{excercise:{default:{},type:Object}},setup(){return{jlconfig:w}},methods:{onSelectExam(e,t){J()?t?b.fire({title:"Locked Topic",text:"You did not read all the materials of this topic",icon:"warning"}):this.$emit("view",S(e)):b.fire({title:"Sign In Required",html:"Please Login first",icon:"warning"})}}}),he={class:"p-5 mx-5"},pe={class:"row"},me={class:"card"},fe={class:"card-body"},_e={key:0,class:"badge bg-success"},ye={key:1,class:"badge bg-danger"},we={key:2,class:"badge bg-secondary"},be={class:"card-footer d-flex justify-content-end"},ge=["onClick"],ve={key:0,class:"bi bi-lock-fill me-1"},$e={key:1,class:"bi bi-check-circle-fill me-1"},ke={key:2,class:"bi bi-unlock-fill me-1"};function Se(e,t,i,d,p,m){return r(),a("div",he,[s("div",pe,[(r(!0),a(A,null,N(e.excercise,(o,n)=>{var f;return r(),a("div",{class:"col-4 mb-5",key:n},[s("div",me,[t[3]||(t[3]=s("img",{src:te},null,-1)),s("div",fe,[s("h3",null,c((f=o==null?void 0:o.header)==null?void 0:f.name),1),s("table",null,[s("tbody",null,[s("tr",null,[t[0]||(t[0]=s("td",{style:{width:"180px"}},"Number of items",-1)),s("td",null,": "+c(e.jlconfig.excercises_limit),1)]),s("tr",null,[t[2]||(t[2]=s("td",null,"Status",-1)),s("td",null,[t[1]||(t[1]=L(": ")),o!=null&&o.passed?(r(),a("span",_e,"Passed")):(o==null?void 0:o.attempt)>0?(r(),a("span",ye,"Fail")):(r(),a("span",we,"Pending"))])])])])]),s("div",be,[s("button",{class:I(["btn w-100",o!=null&&o.locked?"btn-secondary":o!=null&&o.passed?"btn-success":"btn-primary"]),onClick:_=>e.onSelectExam(o,o==null?void 0:o.locked)},[o!=null&&o.locked?(r(),a("i",ve)):o!=null&&o.passed?(r(),a("i",$e)):(r(),a("i",ke)),s("span",null,c(o!=null&&o.locked?"Locked":o!=null&&o.passed?"Passed":(o==null?void 0:o.attempt)>0?"Take again":"Start Now"),1)],10,ge)])])])}),128))])])}const Qe=M(ue,[["render",Se]]),De=V({name:"ExercisePreviewResult",emits:["back","retry"],props:{category:{type:Object,required:!0},questions:{type:Array,required:!0},score:{type:Number,required:!0},passed:{type:Boolean,required:!0},timeUsed:{type:String,required:!0,default:"00:00"}},data(){return{selectedQuestionIndex:0,selectedQuestion:null,showQuestionModal:!1,choices:{},isSticky:!1}},computed:{typedQuestions(){return this.questions}},mounted(){window.addEventListener("scroll",this.handleScroll),this.handleScroll()},beforeUnmount(){window.removeEventListener("scroll",this.handleScroll),document.body.style.overflow=""},methods:{handleScroll(){const e=window.scrollY;this.isSticky=e>100},onBack(){this.$emit("back")},onRetry(){b.fire({title:"Try Again?",text:"You will restart the exercise with new questions. Are you sure?",icon:"question",showCancelButton:!0,confirmButtonText:"Yes, restart",cancelButtonText:"No, stay here"}).then(e=>{e.isConfirmed&&this.$emit("retry")})},showQuestionDetails(e){this.selectedQuestionIndex=e,this.selectedQuestion=this.questions[e],this.selectedQuestion&&this.selectedQuestion.is_choices&&(this.choices={a:this.selectedQuestion.choice_a||"",b:this.selectedQuestion.choice_b||"",c:this.selectedQuestion.choice_c||"",d:this.selectedQuestion.choice_d||""}),this.showQuestionModal=!0,document.body.style.overflow="hidden"},closeQuestionModal(){this.showQuestionModal=!1,document.body.style.overflow=""},getChoiceClass(e){return this.selectedQuestion?{"bg-success-dark":this.selectedQuestion.is_corrrect===1&&this.selectedQuestion.answer_input===e,"bg-danger":this.selectedQuestion.is_corrrect===0&&this.selectedQuestion.answer_input===e,"bg-success-light":this.selectedQuestion.is_corrrect===0&&this.selectedQuestion.answer.toLowerCase()===e}:{}},truncateQuestion(e,t){return e&&e.length>t?e.substring(0,t)+"...":e||""},formatAnswerWithoutPrefix(e){if(e.is_choices){const i={a:e.choice_a||"",b:e.choice_b||"",c:e.choice_c||"",d:e.choice_d||""}[e.answer_input]||"";return i?this.truncateQuestion(i,30):"Not answered"}else return e.answer_input||"Not answered"}}}),Ce={class:"container mb-4 custom-mt"},Re={class:"row"},Ee={class:"col-sm-12 col-lg-12"},Te={class:"card-header d-flex justify-content-between align-items-center"},Ie={class:"badge bg-primary"},Pe={class:"card-body"},Ue={class:"progress mb-3",style:{height:"20px"}},Be=["aria-valuenow"],Ae={key:0,class:"alert alert-success mb-3"},Ne={key:1,class:"alert alert-danger mb-3"},Le={class:"d-flex align-items-center mb-3"},Ve={class:""},Me={class:"card-body p-0"},Ye={class:"table-responsive"},je={class:"table table-hover table-striped mb-0"},xe=["onClick"],ze={class:"text-center"},Fe={class:"card-footer d-flex justify-content-between"},Ge={class:"question-modal-header"},Oe={class:"question-modal-body"},He={class:"mb-3"},qe={key:0},We={key:1},Ke={class:"input-group mb-3"},Je=["value"],Xe={key:0,class:"input-group mb-3"},Ze=["value"],es={class:"question-modal-footer"};function ss(e,t,i,d,p,m){var o,n,f,_,g,Q,D;return r(),a("div",Ce,[t[15]||(t[15]=s("h1",{class:"text-center"},"Exercise Results",-1)),s("div",Re,[t[12]||(t[12]=s("div",{class:"col-sm-0 col-lg-3"},null,-1)),s("div",Ee,[s("div",{class:I(["card mb-4 mt-2 sticky-card",{"is-sticky":e.isSticky}])},[s("div",Te,[t[6]||(t[6]=s("span",null,"Exercise Summary",-1)),s("span",Ie,"Score: "+c(e.score)+" / "+c(e.questions.length),1)]),s("div",Pe,[s("div",Ue,[s("div",{class:"progress-bar bg-success",role:"progressbar",style:H({width:e.score/e.questions.length*100+"%"}),"aria-valuenow":e.score/e.questions.length*100,"aria-valuemin":0,"aria-valuemax":"100"},c(Math.round(e.score/e.questions.length*100))+"% ",13,Be)]),e.passed?(r(),a("div",Ae,t[7]||(t[7]=[s("i",{class:"bi bi-check-circle-fill me-2"},null,-1),L(" Congratulations! You passed the exercise. ")]))):(r(),a("div",Ne,t[8]||(t[8]=[s("i",{class:"bi bi-x-circle-fill me-2"},null,-1),L(" You did not pass the exercise. ")]))),s("div",Le,[t[9]||(t[9]=s("div",null,[s("i",{class:"bi bi-alarm fs-3 text-primary me-2"})],-1)),s("div",null,"Remaining Time: "+c(e.timeUsed),1)]),s("div",Ve,[t[11]||(t[11]=s("div",{class:"card-header d-flex justify-content-between align-items-center"},[s("strong",null,"Questions Overview"),s("p",null,"Select list to view")],-1)),s("div",Me,[s("div",Ye,[s("table",je,[t[10]||(t[10]=s("thead",null,[s("tr",null,[s("th",{style:{width:"5%"}},"#"),s("th",{style:{width:"65%"}},"Question"),s("th",{style:{width:"30%"}},"Your Answer")])],-1)),s("tbody",null,[(r(!0),a(A,null,N(e.typedQuestions,(u,$)=>(r(),a("tr",{key:$,onClick:U=>e.showQuestionDetails($),role:"button",class:"question-row"},[s("td",ze,c($+1),1),s("td",null,c(u.question),1),s("td",{class:I(u.is_corrrect===1?"text-success fw-bold":"text-danger fw-bold")},c(e.formatAnswerWithoutPrefix(u)),3)],8,xe))),128))])])])])])]),s("div",Fe,[s("button",{class:"btn btn-secondary",onClick:t[0]||(t[0]=(...u)=>e.onBack&&e.onBack(...u))},"Back to Categories"),s("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=(...u)=>e.onRetry&&e.onRetry(...u))},"Try Again")])],2)])]),e.showQuestionModal?(r(),a("div",{key:0,class:"question-modal-overlay",onClick:t[5]||(t[5]=(...u)=>e.closeQuestionModal&&e.closeQuestionModal(...u))},[s("div",{class:"question-modal-content",onClick:t[4]||(t[4]=X(()=>{},["stop"]))},[s("div",Ge,[s("h5",null,"Question "+c(e.selectedQuestionIndex+1),1),s("button",{type:"button",class:"btn-close",onClick:t[2]||(t[2]=(...u)=>e.closeQuestionModal&&e.closeQuestionModal(...u))})]),s("div",Oe,[s("p",He,c((o=e.selectedQuestion)==null?void 0:o.question),1),(n=e.selectedQuestion)!=null&&n.is_choices?(r(),a("div",qe,[(r(!0),a(A,null,N(e.choices,(u,$,U)=>(r(),a("div",{key:$,class:I(["choice-option p-3 mb-2 rounded",e.getChoiceClass($)])},c(u),3))),128))])):(r(),a("div",We,[s("div",Ke,[t[13]||(t[13]=s("span",{class:"input-group-text"},"Your Answer",-1)),s("input",{type:"text",class:I(["form-control",{"bg-success-dark text-white":((f=e.selectedQuestion)==null?void 0:f.is_corrrect)===1,"bg-danger text-white":((_=e.selectedQuestion)==null?void 0:_.is_corrrect)===0}]),value:(g=e.selectedQuestion)==null?void 0:g.answer_input,disabled:""},null,10,Je)]),((Q=e.selectedQuestion)==null?void 0:Q.is_corrrect)===0?(r(),a("div",Xe,[t[14]||(t[14]=s("span",{class:"input-group-text"},"Correct Answer",-1)),s("input",{type:"text",class:"form-control bg-success-light",value:(D=e.selectedQuestion)==null?void 0:D.answer,disabled:""},null,8,Ze)])):E("",!0)]))]),s("div",es,[s("button",{type:"button",class:"btn btn-secondary",onClick:t[3]||(t[3]=(...u)=>e.closeQuestionModal&&e.closeQuestionModal(...u))},"Close")])])])):E("",!0)])}const ts=M(De,[["render",ss],["__scopeId","data-v-ac0b2181"]]),is=V({name:"ExamSpace",emits:["back","passed","fail"],props:{reset:{default:0,type:Number},category:{default:{},type:Object},questionnaires:{default:[],type:Object}},components:{Swiper:K,SwiperSlide:W,ExercisePreviewResult:ts},setup(){return{store:Z()}},data(){return{loading:{btn_submit:!1},user:{},swiper:{},list:[],score:0,passed:0,timeDisplay:{},exercise_duration:0,backButton:!1,stopTimer:null,isUserTryingToLeave:!1,isTimesUp:!1,answeredQuestions:[],canNavigatePrevious:!1,showResults:!1}},methods:{onPrevious(){this.swiper.activeIndex>0&&this.swiper.slidePrev()},async onBack(){var e;if(this.isTimesUp){(e=this.timeDisplay)!=null&&e.intervalID&&clearInterval(this.timeDisplay.intervalID),this.$router.push({path:this.$route.path,query:{}}),this.$emit("back");return}b.fire({title:"Are you sure?",text:"You will lose all your progress, are you sure you want to leave?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, cancel",cancelButtonText:"No, continue"}).then(async t=>{var i;t.isConfirmed&&((i=this.timeDisplay)!=null&&i.intervalID&&clearInterval(this.timeDisplay.intervalID),this.$router.push({path:this.$route.path,query:{}}),this.$emit("back"))})},async startTimer(){this.stopTimer=de(async e=>{var t;R("Reading Time:",S(e)),this.timeDisplay=e,(e==null?void 0:e.seconds)===0&&(console.log("time is up"),this.isTimesUp=!0,this.$router.push({path:this.$route.path,query:{isTimesUp:"true"}}),(t=this.timeDisplay)!=null&&t.intervalID&&clearInterval(this.timeDisplay.intervalID),b.fire({title:"Time's up",text:"Your exercise time has ended.",icon:"info"}).then(async()=>{await this.onSaveExcercises().then(async()=>{this.loading.btn_submit=!1,this.showResults=!0})}))},this.exercise_duration)},async onSubmitAnswer(e){if(!this.list[e].answer_input)this.$toast.warning("Please provide your answer.");else{var t=this.list[e].answer.toLowerCase(),i=this.list[e].answer_input.toLowerCase();t==i?(this.score=this.score+1,this.list[e].is_corrrect=1):this.list[e].is_corrrect=0,this.answeredQuestions.includes(e)||this.answeredQuestions.push(e),this.answeredQuestions.length>0&&(this.canNavigatePrevious=!0),this.swiper.isEnd?(this.score>=w.excercises_limit_passing&&(this.passed=1),this.loading.btn_submit=!0,await this.onSaveExcercises().then(async()=>{var m;this.loading.btn_submit=!1,(m=this.timeDisplay)!=null&&m.intervalID&&clearInterval(this.timeDisplay.intervalID),this.isTimesUp=!0,this.$router.push({path:this.$route.path,query:{}});const d=this.passed?`Congratulations! You passed the exercise with a score of ${this.score}/${w.excercises_limit}.`:`You failed the exercise with a score of ${this.score}/${w.excercises_limit}. Better luck next time!`,p=this.passed?"success":"error";await b.fire({title:this.passed?"Exercise Passed!":"Exercise Failed",text:d,icon:p,confirmButtonText:"View Results"}),this.showResults=!0})):this.swiper.slideNext()}},async onSaveExcercises(){var e,t,i;await le({connection:ae().CONN_NPM_LMS,table:"questionnaire_category_done",columns:{user_refid:(e=this.user)==null?void 0:e.user_refid,category_refid:(i=(t=this.category)==null?void 0:t.header)==null?void 0:i.group_refid,total:w.excercises_limit,score:this.score,passed:this.passed}})},onSwiper(e){this.swiper=e},onResultsBack(){this.$emit("back")},onResultsRetry(){this.showResults=!1,this.score=0,this.passed=0,this.isTimesUp=!1,this.answeredQuestions=[],this.canNavigatePrevious=!1,this.list.forEach(e=>{e.answer_input="",e.is_corrrect=0}),this.swiper.slideTo(0),this.startTimer()}},watch:{timeDisplay:function(e,t){(e==null?void 0:e.intervalID)!==(t==null?void 0:t.intervalID)&&(this.store.commit("addIntervalId",e==null?void 0:e.intervalID),console.log("added interval id"))},reset:async function(){if(this.reset>0){var e=await q();e?(this.user=e,this.list=this.questionnaires,this.score=0,this.passed=0,this.isTimesUp=!1,this.showResults=!1,this.swiper.slideTo(0),this.answeredQuestions=[],this.canNavigatePrevious=!1,R("Props:",S(this.$props)),R("Data:",S(this.$data)),this.$router.push({path:this.$route.path,query:{isExerciseOngoing:"true"}}),this.startTimer()):(this.$router.replace("/login"),b.fire({title:"Sign In Required",text:"You need to sign in to start an exercise",icon:"info"}))}}},created(){this.exercise_duration=w.exercise_time*60,this.isTimesUp=!1,this.answeredQuestions=[],this.canNavigatePrevious=!1,this.showResults=!1},beforeUnmount(){var e;console.log("Component Destroyed!"),(e=this.timeDisplay)!=null&&e.intervalID&&clearInterval(this.timeDisplay.intervalID)}}),os={key:0},ns={class:"text-center"},rs={class:"row"},as={class:"col-sm-12 col-lg-6"},ls={class:"mb-3 mt-2"},ds={class:"p-3"},cs={class:"d-flex align-items-center"},us={class:"flex-grow-1"},hs={class:"d-flex justify-content-between align-items-center"},ps={class:"p-0 m-0 fw-bold"},ms={class:"badge bg-primary"},fs={key:0,class:"progress mt-2",style:{height:"8px"}},_s=["aria-valuenow"],ys={class:"card mb-4 mt-2"},ws={class:"card-header d-flex justify-content-between align-items-center"},bs={class:"badge bg-secondary"},gs={class:"card-body"},vs={key:0},$s={class:"form-check mb-2"},ks=["onUpdate:modelValue","name","id"],Ss=["for"],Qs={class:"form-check mb-2"},Ds=["onUpdate:modelValue","name","id"],Cs=["for"],Rs={class:"form-check mb-2"},Es=["onUpdate:modelValue","name","id"],Ts=["for"],Is={class:"form-check mb-2"},Ps=["onUpdate:modelValue","name","id"],Us=["for"],Bs={key:1,class:"input-group mb-3"},As=["onUpdate:modelValue"],Ns={class:"card-footer d-flex justify-content-between"},Ls=["disabled"],Vs=["onClick","disabled"],Ms={key:0},Ys={key:1},js={class:"row mt-3"},xs={class:"col-sm-12 col-lg-6 d-flex justify-content-start"};function zs(e,t,i,d,p,m){var _,g,Q,D,u,$,U,j,x,z,F,G,O;const o=v("swiper-slide"),n=v("swiper"),f=v("exercise-preview-result");return r(),a("div",null,[e.showResults?E("",!0):(r(),a("div",os,[s("h1",ns,c((g=(_=e.category)==null?void 0:_.header)==null?void 0:g.name),1),s("div",rs,[t[5]||(t[5]=s("div",{class:"col-sm-0 col-lg-3"},null,-1)),s("div",as,[s("div",ls,[s("div",ds,[s("div",cs,[t[2]||(t[2]=s("div",null,[s("i",{class:"bi bi-alarm fs-3 me-3 text-primary"})],-1)),s("div",us,[s("div",hs,[s("p",ps,c((Q=e.timeDisplay)!=null&&Q.formatted?(D=e.timeDisplay)==null?void 0:D.formatted:"00:00:00"),1),s("span",ms," Used: "+c((u=e.timeDisplay)!=null&&u.percentage?((U=($=e.timeDisplay)==null?void 0:$.percentage)==null?void 0:U.used)+"%":"0%"),1)]),(j=e.timeDisplay)!=null&&j.percentage?(r(),a("div",fs,[s("div",{class:"progress-bar progress-bar-striped bg-primary",role:"progressbar",style:H({width:((z=(x=e.timeDisplay)==null?void 0:x.percentage)==null?void 0:z.used)+"%"}),"aria-valuenow":(G=(F=e.timeDisplay)==null?void 0:F.percentage)==null?void 0:G.used,"aria-valuemin":0,"aria-valuemax":"100"},null,12,_s)])):E("",!0)])])])]),k(n,{"slides-per-view":1,onSwiper:e.onSwiper},{default:P(()=>[(r(!0),a(A,null,N(e.list,(l,h)=>(r(),Y(o,{class:"swiper-no-swiping",key:h},{default:P(()=>[s("div",ys,[s("div",ws,[s("span",null,"Question: "+c(h+1),1),s("span",bs,c(h+1)+" of "+c(e.list.length),1)]),s("div",gs,[s("p",null,c(l==null?void 0:l.question),1),l!=null&&l.is_choices?(r(),a("div",vs,[s("div",$s,[T(s("input",{"onUpdate:modelValue":y=>l.answer_input=y,class:"form-check-input",type:"radio",name:"flexRadioDefault_"+h,id:"choice_a_"+h,value:"a"},null,8,ks),[[B,l.answer_input]]),s("label",{class:"form-check-label",for:"choice_a_"+h},c(l==null?void 0:l.choice_a),9,Ss)]),s("div",Qs,[T(s("input",{"onUpdate:modelValue":y=>l.answer_input=y,class:"form-check-input",type:"radio",name:"flexRadioDefault_"+h,id:"choice_b_"+h,value:"b"},null,8,Ds),[[B,l.answer_input]]),s("label",{class:"form-check-label",for:"choice_b_"+h},c(l==null?void 0:l.choice_b),9,Cs)]),s("div",Rs,[T(s("input",{"onUpdate:modelValue":y=>l.answer_input=y,class:"form-check-input",type:"radio",name:"flexRadioDefault_"+h,id:"choice_c_"+h,value:"c"},null,8,Es),[[B,l.answer_input]]),s("label",{class:"form-check-label",for:"choice_c_"+h},c(l==null?void 0:l.choice_c),9,Ts)]),s("div",Is,[T(s("input",{"onUpdate:modelValue":y=>l.answer_input=y,class:"form-check-input",type:"radio",name:"flexRadioDefault_"+h,id:"choice_d_"+h,value:"d"},null,8,Ps),[[B,l.answer_input]]),s("label",{class:"form-check-label",for:"choice_d_"+h},c(l==null?void 0:l.choice_d),9,Us)])])):(r(),a("div",Bs,[t[3]||(t[3]=s("span",{class:"input-group-text"},"Answer",-1)),T(s("input",{"onUpdate:modelValue":y=>l.answer_input=y,type:"text",class:"form-control"},null,8,As),[[ee,l.answer_input]])]))]),s("div",Ns,[s("button",{class:"btn btn-secondary w-49",onClick:t[0]||(t[0]=y=>e.onPrevious()),disabled:!e.canNavigatePrevious},"Previous",8,Ls),s("button",{class:"btn btn-primary w-49",onClick:y=>e.onSubmitAnswer(h),disabled:e.loading.btn_submit},[e.loading.btn_submit?(r(),a("span",Ms,t[4]||(t[4]=[s("span",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),L(" Please wait.. ")]))):(r(),a("span",Ys,"Submit Answer"))],8,Vs)])])]),_:2},1024))),128))]),_:1},8,["onSwiper"])])]),s("div",js,[t[6]||(t[6]=s("div",{class:"col-sm-0 col-lg-3"},null,-1)),s("div",xs,[s("button",{class:"btn btn-secondary w-50",onClick:t[1]||(t[1]=l=>e.onBack())},"Back")])])])),e.showResults?(r(),Y(f,{key:1,category:e.category,questions:e.list,score:e.score,passed:!!e.passed,timeUsed:((O=e.timeDisplay)==null?void 0:O.formatted)||"00:00:00",onBack:e.onResultsBack,onRetry:e.onResultsRetry},null,8,["category","questions","score","passed","timeUsed","onBack","onRetry"])):E("",!0)])}const Fs=M(is,[["render",zs],["__scopeId","data-v-d6a5c29b"]]),Gs=V({components:{ElemProgressbar:ce,ExamSpace:Fs,TopicList:Qe,SectionHeader:re,SectionFooter:ne,Swiper:K,SwiperSlide:W},setup(){return{jlconfig:w}},data(){return{timeDisplay:{},exerciseStarted:!1,loading:!1,user:{},btn:{array:!0,search:!1,sorting:!1,linked_list:!1,graphs:!1,stacks:!1,queues:!1},linked_list_locked:!1,list_stacks_locked:!1,list_queues_locked:!1,list_graphs_locked:!1,list_arrays_locked:!1,list_sorting_locked:!1,list_searching_locked:!1,swiper:{},excercise:[],reset:0,category:{},questionnaires:{},all_passed:!1,examVue:!0,confettiRunning:!1}},methods:{async isArticleGroupDoneLocal(){var e,t,i,d,p,m,o;await C((e=this.user)==null?void 0:e.user_refid,"ARRAYS").then(async n=>{this.list_arrays_locked=!(n!=null&&n.success)}),await C((t=this.user)==null?void 0:t.user_refid,"LINKED_LIST").then(async n=>{this.linked_list_locked=!(n!=null&&n.success)}),await C((i=this.user)==null?void 0:i.user_refid,"STACKS").then(async n=>{this.list_stacks_locked=!(n!=null&&n.success)}),await C((d=this.user)==null?void 0:d.user_refid,"QUEUES").then(async n=>{this.list_queues_locked=!(n!=null&&n.success)}),await C((p=this.user)==null?void 0:p.user_refid,"GRAPHS").then(async n=>{this.list_graphs_locked=!(n!=null&&n.success)}),await C((m=this.user)==null?void 0:m.user_refid,"SORTING").then(async n=>{this.list_sorting_locked=!(n!=null&&n.success)}),await C((o=this.user)==null?void 0:o.user_refid,"SEARCH").then(async n=>{this.list_searching_locked=!(n!=null&&n.success)})},async initExercises(){var e;this.loading=!0,await se({url:"util_quiz/initExcercises?user_refid="+((e=this.user)==null?void 0:e.user_refid)+"&limit="+w.excercises_limit}).then(async t=>{this.loading=!1,t=t.map(i=>{var p,m,o,n,f,_,g;let d=!0;return((p=i==null?void 0:i.header)==null?void 0:p.name)==="Array"?d=this.list_arrays_locked:((m=i==null?void 0:i.header)==null?void 0:m.name)==="Linked List"?d=this.linked_list_locked:((o=i==null?void 0:i.header)==null?void 0:o.name)==="Stacks"?d=this.list_stacks_locked:((n=i==null?void 0:i.header)==null?void 0:n.name)==="Queues"?d=this.list_queues_locked:((f=i==null?void 0:i.header)==null?void 0:f.name)==="Graphs"?d=this.list_graphs_locked:((_=i==null?void 0:i.header)==null?void 0:_.name)==="Sorting"?d=this.list_sorting_locked:((g=i==null?void 0:i.header)==null?void 0:g.name)==="Searching"&&(d=this.list_searching_locked),{...i,locked:d}}),this.excercise=t,console.log("exercise, ",this.excercise),this.isPassedAll()})},isPassedAll(){var e=0;for(let t=0;t<this.excercise.length;t++)this.excercise[t].passed&&(e+=1);R("Over all status",{total:this.excercise.length,passed:e}),this.excercise.length===e?this.all_passed||(this.all_passed=!0,this.startConfetti(),b.fire({title:"Congratulations!",text:"You passed all the exercises, proceed to quiz!",imageUrl:"/src/assets/img/new-passedall.png",confirmButtonText:"Go to Quiz"}).then(t=>{t.isConfirmed&&(this.stopConfetti(),this.$router.replace("/quizzes"))})):this.all_passed=!1},startConfetti(){if(this.confettiRunning)return;this.confettiRunning=!0;const e=["#bb0000","#161179","#015551"],t=Date.now()+1e4,i=()=>{confetti({particleCount:5,angle:60,spread:55,origin:{x:0},colors:e}),confetti({particleCount:5,angle:120,spread:55,origin:{x:1},colors:e}),Date.now()<t&&this.confettiRunning?requestAnimationFrame(i):this.confettiRunning=!1};i()},stopConfetti(){this.confettiRunning=!1},async viewExam(e){var t;if(R("View Exam",e),e!=null&&e.passed)b.fire({title:"Completed",text:"You've passed the exercises already",icon:"info"});else{this.examVue=!0,this.loading=!0,this.category=S(e);const i={group_refid:(t=e==null?void 0:e.header)==null?void 0:t.group_refid,limit:w.excercises_limit};await ie(i).then(async d=>{d=d==null?void 0:d.filter(p=>!(p!=null&&p.is_choices)).slice(0,w.excercises_limit),d.length<w.excercises_limit?(b.fire({title:"Wait",text:"Questions in this exercise are not yet prepared.",icon:"info"}),this.loading=!1):(this.loading=!1,this.questionnaires=S(d),this.reset=oe(),this.swiper.slideTo(1),this.exerciseStarted=!0)})}},onSwiper(e){this.swiper=e},onBack(){this.swiper.slideTo(0),this.examVue=!1},async onPassed(e){this.swiper.slideTo(0),this.examVue=!1,e&&e.categoryId&&(this.excercise=this.excercise.map(t=>t.header.group_refid===e.categoryId?{...t,completed:!0,passed:!0,attempt:(t.attempt||0)+1,score:e.score}:t)),await this.initExercises()},async onFail(e){this.swiper.slideTo(0),this.examVue=!1,e&&e.categoryId&&(this.excercise=this.excercise.map(t=>t.header.group_refid===e.categoryId?{...t,completed:!0,passed:!1,attempt:(t.attempt||0)+1,score:e.score}:t)),await this.initExercises()},async proceedToQuiz(){this.stopConfetti(),this.all_passed?this.$router.replace("/quizzes"):b.fire({title:"Invalid Action",text:"You need to pass all exercises to proceed to the quiz",icon:"info"})}},async mounted(){var e=await q();e&&(this.user=e),await this.isArticleGroupDoneLocal(),R("Exercises:",S(this.$data)),await this.initExercises(),R("Exercises:",S(this.$data)),this.$router.push({path:this.$route.path,query:{}})},beforeRouteLeave(e,t,i){this.stopConfetti(),i()}}),Os={class:"main"},Hs={class:"container mt-5 py-5"},qs={class:"row pt-5"},Ws={class:"col-4"},Ks={class:"col-12"},Js={class:"col-12"},Xs={class:"d-flex justify-content-center"},Zs={key:0,class:"bi bi-lock-fill me-1"},et={key:1,class:"bi bi-unlock-fill me-1"};function st(e,t,i,d,p,m){const o=v("SectionHeader"),n=v("ElemProgressbar"),f=v("TopicList"),_=v("swiper-slide"),g=v("ExamSpace"),Q=v("swiper"),D=v("SectionFooter");return r(),a("div",null,[k(o),s("main",Os,[s("div",Hs,[s("div",qs,[t[3]||(t[3]=s("div",{class:"col-12"},[s("h1",{class:"text-center fw-bold display-6"},"Exercises"),s("p",{class:"text-center"},"Please complete reading materials to start exercises")],-1)),t[4]||(t[4]=s("div",{class:"col-4"},null,-1)),s("div",Ws,[k(n,{loading:e.loading},null,8,["loading"])]),t[5]||(t[5]=s("div",{class:"col-4"},null,-1)),s("div",Ks,[k(Q,{"slides-per-view":1,"space-between":0,onSwiper:e.onSwiper},{default:P(()=>[k(_,{class:"swiper-no-swiping"},{default:P(()=>[k(f,{excercise:e.excercise,onView:e.viewExam},null,8,["excercise","onView"])]),_:1}),e.examVue?(r(),Y(_,{key:0,class:"swiper-no-swiping"},{default:P(()=>[k(g,{reset:e.reset,category:e.category,questionnaires:e.questionnaires,onBack:e.onBack,onPassed:e.onPassed,onFail:e.onFail},null,8,["reset","category","questionnaires","onBack","onPassed","onFail"])]),_:1})):E("",!0)]),_:1},8,["onSwiper"])]),s("div",Js,[t[2]||(t[2]=s("p",{class:"text-center"},"Quiz will enable once you passed all exercises",-1)),s("div",Xs,[s("button",{class:"btn btn-primary btn-lg",onClick:t[0]||(t[0]=u=>e.proceedToQuiz())},[e.all_passed?(r(),a("i",et)):(r(),a("i",Zs)),t[1]||(t[1]=s("span",null,"Proceed to Quiz",-1))])])])])])]),k(D)])}const _t=M(Gs,[["render",st],["__scopeId","data-v-05b27f27"]]);export{_t as default};
