import{d as C,i as P,_ as N,c as b,e as p,a as e,f as g,I as q,s as u,v as c,k as A,g as h,j as M,w as $,o as y}from"./index-D7cRCgpj.js";import{S as w}from"./config-Cif4XynF.js";import{q as D}from"./insertGetID-BAx1ISz1.js";import{q as V}from"./count-B2fEAVCc.js";import{S as k,a as U}from"./SectionFooter-upHGNFKG.js";import"./format-CV38ky4f.js";function E(t){var s=3;let n="";const i="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",d=i.length;let m=0;for(;m<s;)n+=i.charAt(Math.floor(Math.random()*d)),m+=1;var a=new Date,l=a.getFullYear(),r=a.getMonth()+1,o=a.getDate(),f=a.getHours(),v=a.getMinutes(),S=a.getSeconds(),_=l+""+r+o+f+v+S;return t+"-"+_+"-"+n}async function F({firstname:t,lastname:s,email:n,password:i,confirm_password:d,created_by:m}){const a=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;let l=!1;return await V({connection:w().CONN_NPM_LMS,table:"users_student",where:[["email",n]]}).then(async r=>l=!!r),new Promise(async r=>{if(t=="")return r({success:!1,message:"First name is required"});if(s=="")return r({success:!1,message:"Last name is required"});if(n=="")return r({success:!1,message:"Please provide email"});if(i=="")return r({success:!1,message:"Please provide default password"});if(d=="")return r({success:!1,message:"Please confirm your password"});if(i!==d)return r({success:!1,message:"Password doesn't match"});if(i.length<8)return r({success:!1,message:"Password must be 8 or more characters"});if(a.test(n.toString())){if(l)return r({success:!1,message:"email already used."});var o=E("STD");await D({connection:w().CONN_NPM_LMS,table:"users_student",columns:{user_refid:o,firstname:t,lastname:s,email:n,password:i,created_by:m}}).then(async f=>r(f))}else return r({success:!1,message:"email invalid."})})}const I=C({name:"SignUpPage",components:{SectionFooter:U,SectionHeader:k},data(){return{loading:!1,form:{email:"",password:"",confirm_password:"",firstname:"",lastname:"",created_by:""}}},methods:{resetData(){this.form.email="",this.form.firstname="",this.form.lastname="",this.form.created_by="",this.form.password="",this.form.confirm_password=""},async register(){if(this.form.password!==this.form.confirm_password){this.$toast.warning("Passwords do not match");return}this.loading=!0;try{const t=await F(this.form);t.success?(this.resetData(),this.$toast.success((t==null?void 0:t.message)||"Account created successfully"),setTimeout(()=>{this.$router.push("/login")},1500)):this.$toast.warning((t==null?void 0:t.message)||"Registration failed")}catch(t){this.$toast.error("An error occurred while creating your account"),console.error(t)}finally{this.loading=!1}}},async mounted(){P()&&this.$router.replace("/")}}),L={class:"auth-wrapper"},T={class:"main py-5"},H={class:"auth-container"},B={class:"card mt-5 border-0"},R={class:"card-body p-5"},Z={class:"auth-form"},x={class:"row"},z={class:"col-md-6 mb-4"},O={class:"col-md-6 mb-4"},G={class:"mb-4"},Y={class:"input-group"},j={class:"mb-4"},J={class:"input-group"},K={class:"mb-4"},Q={class:"input-group"},W={class:"d-grid gap-2 mt-4"},X=["disabled"],ss={key:0,class:"spinner-border spinner-border-sm me-2",role:"status"},es={class:"text-center mt-4"};function ts(t,s,n,i,d,m){const a=g("SectionHeader"),l=g("router-link"),r=g("SectionFooter");return y(),b("div",L,[p(a),e("main",T,[e("div",H,[e("div",B,[e("div",R,[e("div",Z,[s[17]||(s[17]=e("div",{class:"text-center mb-4"},[e("h1",{class:"display-6 fw-bold"},"AlgoSpear"),e("p",{class:"text-muted"},"Create your account")],-1)),e("form",{onSubmit:s[5]||(s[5]=q((...o)=>t.register&&t.register(...o),["prevent"]))},[e("div",x,[e("div",z,[s[6]||(s[6]=e("label",{class:"form-label"},"First Name",-1)),u(e("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>t.form.firstname=o),class:"form-control form-control-lg",type:"text",placeholder:"Enter your first name",required:""},null,512),[[c,t.form.firstname]])]),e("div",O,[s[7]||(s[7]=e("label",{class:"form-label"},"Last Name",-1)),u(e("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>t.form.lastname=o),class:"form-control form-control-lg",type:"text",placeholder:"Enter your last name",required:""},null,512),[[c,t.form.lastname]])])]),e("div",G,[s[9]||(s[9]=e("label",{class:"form-label"},"Email",-1)),e("div",Y,[s[8]||(s[8]=e("span",{class:"input-group-text bg-light border-end-0"},[e("i",{class:"bi bi-envelope"})],-1)),u(e("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.form.email=o),class:"form-control form-control-lg border-start-0",type:"email",placeholder:"Enter your email",required:""},null,512),[[c,t.form.email]])])]),e("div",j,[s[11]||(s[11]=e("label",{class:"form-label"},"Password",-1)),e("div",J,[s[10]||(s[10]=e("span",{class:"input-group-text bg-light border-end-0"},[e("i",{class:"bi bi-lock"})],-1)),u(e("input",{"onUpdate:modelValue":s[3]||(s[3]=o=>t.form.password=o),class:"form-control form-control-lg border-start-0",type:"password",placeholder:"Create a password",required:""},null,512),[[c,t.form.password]])]),s[12]||(s[12]=e("small",{class:"text-muted"},"Password must be at least 8 characters",-1))]),e("div",K,[s[14]||(s[14]=e("label",{class:"form-label"},"Confirm Password",-1)),e("div",Q,[s[13]||(s[13]=e("span",{class:"input-group-text bg-light border-end-0"},[e("i",{class:"bi bi-lock-fill"})],-1)),u(e("input",{"onUpdate:modelValue":s[4]||(s[4]=o=>t.form.confirm_password=o),class:"form-control form-control-lg border-start-0",type:"password",placeholder:"Confirm your password",required:""},null,512),[[c,t.form.confirm_password]])])]),e("div",W,[e("button",{type:"submit",class:"btn btn-primary btn-lg",disabled:t.loading},[t.loading?(y(),b("span",ss)):A("",!0),h(" "+M(t.loading?"Creating account...":"Create Account"),1)],8,X)])],32),e("div",es,[s[16]||(s[16]=e("p",{class:"text-muted mb-0"},"Already have an account?",-1)),p(l,{to:"/login",class:"btn btn-outline-primary mt-2"},{default:$(()=>s[15]||(s[15]=[h("Sign in")])),_:1})])])])])])]),p(r)])}const ds=N(I,[["render",ts],["__scopeId","data-v-a673cd38"]]);export{ds as default};
